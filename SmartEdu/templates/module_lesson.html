{% extends "base.html" %}

{% block content %}
<!-- Module Header -->
<section style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(124, 58, 237, 0.1)); padding: 2rem 0; margin-bottom: 2rem;">
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <a href="{{ url_for('elearning.course_detail', course_id=course_id) }}" style="color: var(--primary); text-decoration: none;">‚Üê Back to Course</a>
                <h1 style="margin: 0.5rem 0 0 0;">Module {{ module_num }}: {{ module_title }}</h1>
                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">{{ course_name }}</p>
            </div>
            <div style="text-align: right;">
                <p style="color: var(--text-tertiary); margin: 0;">Module {{ module_num }} of 3</p>
            </div>
        </div>
    </div>
</section>

<!-- Main Content -->
<section>
    <div class="container">
        <div style="max-width: 1000px; margin: 0 auto;">
            <!-- Video Section -->
            <div class="card" style="margin-bottom: 2rem;">
                {% if module_info.video_url %}
                    <div style="aspect-ratio: 16/9; border-radius: 12px; overflow: hidden;">
                        <iframe 
                            width="100%" 
                            height="100%" 
                            src="{{ module_info.video_url }}" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen
                            style="border-radius: 8px;">
                        </iframe>
                    </div>
                {% else %}
                    <div style="aspect-ratio: 16/9; background: linear-gradient(135deg, #2563eb, #7c3aed); display: flex; align-items: center; justify-content: center; border-radius: 12px; overflow: hidden;">
                        <div style="text-align: center; color: white;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">‚ñ∂</div>
                            <p style="font-size: 1.3rem; font-weight: 600; margin: 0;">Module Video</p>
                            <p style="color: rgba(255,255,255,0.8); margin: 0.5rem 0 0 0;">{% if module_info.video_duration %}{{ module_info.video_duration }}{% else %}45 minutes{% endif %}</p>
                        </div>
                    </div>
                {% endif %}
            </div>

            <!-- Content Tabs -->
            <div style="display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid var(--border); overflow-x: auto;">
                <button onclick="switchTab(event, 'overview')" class="tab-btn active" style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid var(--primary); cursor: pointer; font-weight: 600; color: var(--text-primary); font-size: 1rem; white-space: nowrap;">üìñ Overview</button>
                <button onclick="switchTab(event, 'lessons')" class="tab-btn" style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid transparent; cursor: pointer; font-weight: 600; color: var(--text-secondary); font-size: 1rem; white-space: nowrap;">üìö Lessons</button>
                <button onclick="switchTab(event, 'quiz')" class="tab-btn" style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid transparent; cursor: pointer; font-weight: 600; color: var(--text-secondary); font-size: 1rem; white-space: nowrap;">üéØ Quiz</button>
                <button onclick="switchTab(event, 'resources')" class="tab-btn" style="padding: 1rem 1.5rem; background: none; border: none; border-bottom: 3px solid transparent; cursor: pointer; font-weight: 600; color: var(--text-secondary); font-size: 1rem; white-space: nowrap;">üìé Resources</button>
            </div>

            <!-- Overview Tab -->
            <div id="tab-overview" class="tab-content" style="display: block;">
                <div class="card" style="margin-bottom: 2rem;">
                    <div style="padding: 2rem;">
                        {% if module_info.information %}
                            {{ module_info.information | safe }}
                        {% else %}
                            <h2>Module Overview</h2>
                            <p style="line-height: 1.8; color: var(--text-secondary);">
                                Learn about {{ module_name }}. We'll cover core concepts, practical applications, and real-world examples.
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Lessons Tab -->
            <div id="tab-lessons" class="tab-content" style="display: none;">
                <div class="card" style="margin-bottom: 2rem;">
                    <div style="padding: 2rem;">
                        <h2>Learning Objectives</h2>
                        <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1.5rem;">
                            {% if module_info.learning_objectives %}
                                {% for objective in module_info.learning_objectives %}
                                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px; border-left: 4px solid var(--primary);">
                                        <p style="margin: 0; color: var(--text-primary); font-weight: 500;">‚úì {{ objective }}</p>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p style="color: var(--text-secondary);">No learning objectives available.</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz Tab -->
            <div id="tab-quiz" class="tab-content" style="display: none;">
                <div class="card" style="margin-bottom: 2rem;">
                    <div style="padding: 2rem;">
                        <h2>Module Quiz</h2>
                        {% if module_info.quiz_questions %}
                            <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                                Test your knowledge with {{ module_info.quiz_questions | length }} questions. You need 70% to pass.
                            </p>

                            <form id="quiz-form" style="display: flex; flex-direction: column; gap: 2rem;">
                                {% for question in module_info.quiz_questions %}
                                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px; border-left: 4px solid var(--primary);">
                                        <h4 style="margin: 0 0 1rem 0;">{{ loop.index }}. {{ question.question }}</h4>
                                        <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                                            {% for option in question.options %}
                                                <label style="display: flex; align-items: center; gap: 0.8rem; cursor: pointer; padding: 0.8rem; border-radius: 8px; transition: background 0.2s; margin-left: 0;" 
                                                       onmouseover="this.style.background='rgba(37,99,235,0.1)'" 
                                                       onmouseout="this.style.background='transparent'">
                                                    <input type="radio" name="question_{{ loop.index0 }}" value="{{ loop.index0 }}" style="cursor: pointer; width: 18px; height: 18px;">
                                                    <span style="color: var(--text-secondary);">{{ option }}</span>
                                                </label>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endfor %}

                                <button type="submit" style="
                                    padding: 1rem 2rem;
                                    background: var(--primary);
                                    color: white;
                                    border: none;
                                    border-radius: 8px;
                                    font-weight: 600;
                                    cursor: pointer;
                                    font-size: 1rem;
                                    transition: all 0.2s;
                                "
                                onmouseover="this.style.opacity='0.9'; this.style.transform='translateY(-2px)'" 
                                onmouseout="this.style.opacity='1'; this.style.transform='translateY(0)'">
                                    Submit Quiz
                                </button>
                            </form>

                            <div id="quiz-results" style="display: none; margin-top: 2rem;">
                                <div style="padding: 1.5rem; background: #d1fae5; border-radius: 12px; margin-bottom: 1.5rem;">
                                    <h3 style="color: #065f46; margin: 0 0 0.5rem 0;">Quiz Results</h3>
                                    <p style="color: #047857; margin: 0;">
                                        You scored <span id="score-percentage" style="font-weight: 600;">0</span>% 
                                        (<span id="score-count">0</span>/{{ module_info.quiz_questions | length }})
                                    </p>
                                </div>

                                <div id="detailed-results" style="display: flex; flex-direction: column; gap: 1rem;"></div>

                                <button onclick="resetQuiz()" style="
                                    margin-top: 1rem;
                                    padding: 0.8rem 1.5rem;
                                    background: var(--primary);
                                    color: white;
                                    border: none;
                                    border-radius: 8px;
                                    font-weight: 600;
                                    cursor: pointer;
                                "
                                onmouseover="this.style.opacity='0.9'" 
                                onmouseout="this.style.opacity='1'">
                                    Retake Quiz
                                </button>
                            </div>
                        {% else %}
                            <p style="color: var(--text-secondary);">No quiz available for this module yet.</p>
                        {% endif %}
                    </div>
                </div>
            </div>

                            <p style="color: var(--text-tertiary); text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                Showing 2 of 10 questions for demonstration
                            </p>

                            <button onclick="submitQuiz()" class="btn btn-primary" style="padding: 1rem; width: 100%;"><span>Submit Quiz</span></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resources Tab -->
            <div id="tab-resources" class="tab-content" style="display: none;">
                <div class="card" style="margin-bottom: 2rem;">
                    <div style="padding: 2rem;">
                        <h2>Resources</h2>
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <p style="margin: 0; font-weight: 600;">üìÑ Lecture Slides</p>
                                    <p style="color: var(--text-tertiary); margin: 0.25rem 0 0 0;">Complete slides for this module</p>
                                </div>
                                <button onclick="downloadResource('slides')" class="btn btn-small" style="padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer;">Download</button>
                            </div>
                            <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <p style="margin: 0; font-weight: 600;">üìì Study Guide</p>
                                    <p style="color: var(--text-tertiary); margin: 0.25rem 0 0 0;">Key points and summary</p>
                                </div>
                                <button onclick="downloadResource('guide')" class="btn btn-small" style="padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer;">Download</button>
                            </div>
                            <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <p style="margin: 0; font-weight: 600;">üíª Code Examples</p>
                                    <p style="color: var(--text-tertiary); margin: 0.25rem 0 0 0;">Practical code samples</p>
                                </div>
                                <button onclick="downloadResource('code')" class="btn btn-small" style="padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer;">Download</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem; margin-top: 2rem;">
                <a href="{{ url_for('elearning.course_detail', course_id=course_id) }}" class="btn btn-outline" style="text-align: center; text-decoration: none; padding: 1rem;"><span>‚Üê Back to Course</span></a>
                <button onclick="completeModule()" class="btn btn-primary" style="text-align: center; padding: 1rem; cursor: pointer;"><span>‚úì Mark as Complete</span></button>
            </div>
        </div>
    </div>
</section>

<script>
function switchTab(event, tabName) {
    event.preventDefault();
    document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.style.borderBottomColor = 'transparent';
        btn.style.color = 'var(--text-secondary)';
    });
    
    document.getElementById('tab-' + tabName).style.display = 'block';
    event.target.style.borderBottomColor = 'var(--primary)';
    event.target.style.color = 'var(--text-primary)';
}

function submitQuiz() {
    const answers = document.querySelectorAll('input[type="radio"]:checked');
    if (answers.length < 2) {
        alert('Please answer at least 2 questions to submit.');
        return;
    }
    const score = Math.round(Math.random() * 30) + 70;
    alert(`Quiz submitted!\n\nYour Score: ${score}%\n${score >= 70 ? '‚úì You passed! Excellent work!' : '‚úó Please review and try again'}`);
}

function downloadResource(type) {
    alert(`üì• Downloading ${type === 'slides' ? 'Lecture Slides' : type === 'guide' ? 'Study Guide' : 'Code Examples'}...`);
}

function completeModule() {
    alert('‚úì Module marked as complete!\n\nYour progress has been saved. Excellent work!');
}
</script>

        <div class="card" style="margin-bottom: 2rem;">
          <div style="padding: 2rem;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
              <span style="font-size: 2rem;">üìö</span>
              <div>
                <h2 style="margin: 0; font-size: 1.5rem;">Lesson 1: {{ lesson_title }}</h2>
                <p style="margin: 0.5rem 0 0 0; color: var(--text-tertiary);">Duration: 15-20 minutes</p>
              </div>
            </div>

            <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
              <h3 style="margin-top: 0;">Learning Objectives</h3>
              <ul style="margin: 1rem 0 0 0; padding-left: 1.5rem; color: var(--text-secondary);">
                <li>Understand the fundamental concepts</li>
                <li>Apply practical techniques in real scenarios</li>
                <li>Solve problems using new knowledge</li>
                <li>Prepare for advanced topics</li>
              </ul>
            </div>

            <div style="line-height: 1.8; color: var(--text-secondary); margin-bottom: 2rem;">
              <h3>{{ lesson_title }}</h3>
              
              <p>Welcome to {{ lesson_title }}! In this lesson, we'll explore the fundamental concepts and practical applications. This comprehensive guide will help you master the key skills.</p>

              <h4>Key Concepts</h4>
              <p>The main concepts we'll cover include:</p>
              <ul style="padding-left: 1.5rem;">
                <li><strong>Concept 1:</strong> A detailed explanation of the first important concept in this lesson</li>
                <li><strong>Concept 2:</strong> Understanding this concept is crucial for practical application</li>
                <li><strong>Concept 3:</strong> Advanced concept that builds on previous knowledge</li>
                <li><strong>Concept 4:</strong> Real-world applications and best practices</li>
              </ul>

              <h4>Practical Example</h4>
              <p>Let's look at a practical example that demonstrates these concepts:</p>
              <pre style="background: var(--bg-primary); padding: 1rem; border-radius: 8px; overflow-x: auto; font-family: monospace; font-size: 0.9rem;">
// Example Code Snippet
function example() {
  // Initialize with best practices
  const data = [];
  
  // Process and apply concepts
  data.forEach(item => {
    console.log('Processing:', item);
  });
  
  return data;
}

// Expected output shows results</pre>

              <h4>Tips & Tricks</h4>
              <ul style="padding-left: 1.5rem;">
                <li>üí° Always start with the basics before moving to advanced topics</li>
                <li>üéØ Practice with real-world scenarios to reinforce learning</li>
                <li>üìñ Refer to resources and documentation for detailed information</li>
                <li>üîÑ Review and repeat concepts until they become second nature</li>
              </ul>

              <h4>Summary</h4>
              <p>In this lesson, we've covered the essential concepts needed to understand {{ lesson_title }}. You should now be able to:</p>
              <ul style="padding-left: 1.5rem;">
                <li>‚úì Explain the core concepts and their relationships</li>
                <li>‚úì Apply techniques in practical scenarios</li>
                <li>‚úì Recognize when to use different approaches</li>
                <li>‚úì Implement solutions using best practices</li>
              </ul>
            </div>

            <!-- Video Placeholder -->
            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; text-align: center; margin-bottom: 2rem;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">‚ñ∂Ô∏è</div>
              <h4 style="margin: 0 0 0.5rem 0;">Video Lesson: {{ lesson_title }}</h4>
              <p style="margin: 0 0 1rem 0; color: var(--text-tertiary);">14:32 Duration</p>
              <button class="btn btn-primary" onclick="alert('Video player would open here!')"><span>‚ñ∂ Play Video</span></button>
            </div>

            <!-- Resources -->
            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem;">
              <h4 style="margin-top: 0;">üìö Additional Resources</h4>
              <ul style="padding-left: 1.5rem; margin-bottom: 0;">
                <li><a href="#" style="color: var(--primary);">Download Lesson Notes (PDF)</a></li>
                <li><a href="#" style="color: var(--primary);">View Source Code Examples (GitHub)</a></li>
                <li><a href="#" style="color: var(--primary);">Practice Exercises with Solutions</a></li>
                <li><a href="#" style="color: var(--primary);">Recommended Reading and References</a></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="card" id="quiz-section">
          <div style="padding: 2rem;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
              <span style="font-size: 2rem;">‚ùì</span>
              <h2 style="margin: 0;">Quiz: Test Your Knowledge</h2>
            </div>

            <div id="quiz-content">
              <!-- Question 1 -->
              <div class="quiz-question" style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                  <h4 style="margin: 0 0 0.5rem 0;">Question 1 of 4</h4>
                  <span style="color: var(--text-tertiary); font-size: 0.9rem;">25 points</span>
                </div>
                <p style="margin: 1rem 0; font-weight: 500; color: var(--text-primary);">What is the primary concept covered in this lesson?</p>
                
                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q1" value="a" style="cursor: pointer;">
                    <span>Option A: First possible answer</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q1" value="b" style="cursor: pointer;">
                    <span>Option B: Second possible answer (CORRECT)</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q1" value="c" style="cursor: pointer;">
                    <span>Option C: Third possible answer</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q1" value="d" style="cursor: pointer;">
                    <span>Option D: Fourth possible answer</span>
                  </label>
                </div>
              </div>

              <!-- Question 2 -->
              <div class="quiz-question" style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                  <h4 style="margin: 0 0 0.5rem 0;">Question 2 of 4</h4>
                  <span style="color: var(--text-tertiary); font-size: 0.9rem;">25 points</span>
                </div>
                <p style="margin: 1rem 0; font-weight: 500; color: var(--text-primary);">Which of the following is a best practice mentioned in the lesson?</p>
                
                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q2" value="a" style="cursor: pointer;">
                    <span>Option A: Skip the fundamentals</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q2" value="b" style="cursor: pointer;">
                    <span>Option B: Practice with real-world scenarios (CORRECT)</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q2" value="c" style="cursor: pointer;">
                    <span>Option C: Avoid reviewing concepts</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q2" value="d" style="cursor: pointer;">
                    <span>Option D: Ignore best practices</span>
                  </label>
                </div>
              </div>

              <!-- Question 3 & 4 similar structure -->
              <div class="quiz-question" style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                  <h4 style="margin: 0 0 0.5rem 0;">Question 3 of 4</h4>
                  <span style="color: var(--text-tertiary); font-size: 0.9rem;">25 points</span>
                </div>
                <p style="margin: 1rem 0; font-weight: 500; color: var(--text-primary);">What should you do after learning new concepts?</p>
                
                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q3" value="a" style="cursor: pointer;">
                    <span>Option A: Move on immediately</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q3" value="b" style="cursor: pointer;">
                    <span>Option B: Apply and practice (CORRECT)</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q3" value="c" style="cursor: pointer;">
                    <span>Option C: Forget about it</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                    <input type="radio" name="q3" value="d" style="cursor: pointer;">
                    <span>Option D: None of the above</span>
                  </label>
                </div>
              </div>

              <div class="quiz-question" style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                  <h4 style="margin: 0 0 0.5rem 0;">Question 4 of 4</h4>
                  <span style="color: var(--text-tertiary); font-size: 0.9rem;">25 points</span>
                </div>
                <p style="margin: 1rem 0; font-weight: 500; color: var(--text-primary);">How would you rate your understanding of the lesson content?</p>
                
                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                  <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent;">
                    <input type="radio" name="q4" value="1" style="cursor: pointer;">
                    <span>1 - Not at all</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent;">
                    <input type="radio" name="q4" value="2" style="cursor: pointer;">
                    <span>2 - Somewhat</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent;">
                    <input type="radio" name="q4" value="3" style="cursor: pointer;">
                    <span>3 - Moderately</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; background: var(--bg-primary); border-radius: 8px; cursor: pointer; border: 2px solid transparent;">
                    <input type="radio" name="q4" value="4" style="cursor: pointer;">
                    <span>4 - Completely (CORRECT)</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <button class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.1rem; margin-top: 1rem;" onclick="submitQuiz()"><span>üìù Submit Quiz</span></button>
          </div>
        </div>

        <!-- Quiz Results (Hidden initially) -->
        <div class="card" id="results-section" style="display: none;">
          <div style="padding: 2rem; text-align: center;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>
            <h2 style="margin: 0 0 1rem 0;">Quiz Completed!</h2>
            <div style="font-size: 2rem; font-weight: bold; color: var(--primary); margin-bottom: 1rem;">
              <span id="quiz-score">75</span>/100
            </div>
            <p id="quiz-message" style="color: var(--text-secondary); margin-bottom: 2rem;">Great job! You're making excellent progress. Keep it up!</p>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem; text-align: left;">
              <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                <p style="margin: 0; color: var(--text-tertiary); font-size: 0.9rem;">Correct Answers</p>
                <p style="margin: 0.5rem 0 0 0; font-size: 1.5rem; font-weight: bold; color: #10b981;"><span id="correct-count">3</span>/4</p>
              </div>
              <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                <p style="margin: 0; color: var(--text-tertiary); font-size: 0.9rem;">Topics to Review</p>
                <p style="margin: 0.5rem 0 0 0; font-size: 1.5rem; font-weight: bold; color: #f59e0b;"><span id="incorrect-count">1</span></p>
              </div>
            </div>

            <div style="display: flex; gap: 1rem; justify-content: center;">
              <button class="btn btn-primary" onclick="location.reload()"><span>‚Üª Retake Quiz</span></button>
              <a href="{{ url_for('elearning.course_detail', course_id=course_id) }}" class="btn btn-outline"><span>Next Lesson ‚Üí</span></a>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar: Course Navigation -->
      <div>
        <div class="card" style="margin-bottom: 2rem;">
          <div style="padding: 1.5rem;">
            <h3 style="margin-top: 0;">üìö Course Modules</h3>
            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
              <a href="#" class="module-link" style="padding: 0.75rem; background: var(--primary); color: white; border-radius: 8px; text-decoration: none; font-weight: 600;">Module 1: Intro</a>
              <a href="#" class="module-link" style="padding: 0.75rem; background: var(--bg-secondary); color: var(--text-secondary); border-radius: 8px; text-decoration: none; font-size: 0.95rem;">Module 2: Concepts</a>
              <a href="#" class="module-link" style="padding: 0.75rem; background: var(--bg-secondary); color: var(--text-secondary); border-radius: 8px; text-decoration: none; font-size: 0.95rem;">Module 3: Advanced</a>
            </div>
          </div>
        </div>

        <div class="card">
          <div style="padding: 1.5rem;">
            <h3 style="margin-top: 0;">‚úÖ Achievements</h3>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <span style="font-size: 1.5rem;">üèÖ</span>
                <div>
                  <p style="margin: 0; font-weight: 600; font-size: 0.9rem;">First Step</p>
                  <p style="margin: 0; color: var(--text-tertiary); font-size: 0.8rem;">Complete first module</p>
                </div>
              </div>
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <span style="font-size: 1.5rem;">üìñ</span>
                <div>
                  <p style="margin: 0; font-weight: 600; font-size: 0.9rem;">Quick Learner</p>
                  <p style="margin: 0; color: var(--text-tertiary); font-size: 0.8rem;">Complete in under 1 hour</p>
                </div>
              </div>
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <span style="font-size: 1.5rem;">‚≠ê</span>
                <div>
                  <p style="margin: 0; font-weight: 600; font-size: 0.9rem;">Quiz Master</p>
                  <p style="margin: 0; color: var(--text-tertiary); font-size: 0.8rem;">Score 90%+ on all quizzes</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
function switchTab(event, tabName) {
    event.preventDefault();
    
    // Hide all tabs
    const tabs = document.querySelectorAll('.tab-content');
    tabs.forEach(tab => tab.style.display = 'none');
    
    // Remove active state from all buttons
    const buttons = document.querySelectorAll('.tab-btn');
    buttons.forEach(btn => {
        btn.style.borderBottomColor = 'transparent';
        btn.style.color = 'var(--text-secondary)';
    });
    
    // Show selected tab
    document.getElementById('tab-' + tabName).style.display = 'block';
    event.target.style.borderBottomColor = 'var(--primary)';
    event.target.style.color = 'var(--text-primary)';
}

document.getElementById('quiz-form')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // Get all answers
    const answers = [];
    const quizForm = document.getElementById('quiz-form');
    const radios = quizForm.querySelectorAll('input[type="radio"]:checked');
    
    if (radios.length === 0) {
        alert('Please answer at least one question.');
        return;
    }
    
    // Collect answers in order
    radios.forEach(radio => {
        answers.push(parseInt(radio.value));
    });
    
    try {
        const response = await fetch('{{ url_for("elearning.submit_quiz", course_id=course_id, module_id=module_id) }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ answers: answers })
        });
        
        const data = await response.json();
        displayResults(data);
    } catch (error) {
        console.error('Error:', error);
        alert('Error submitting quiz. Please try again.');
    }
});

function displayResults(data) {
    const quizForm = document.getElementById('quiz-form');
    const quizResults = document.getElementById('quiz-results');
    
    // Hide form, show results
    quizForm.style.display = 'none';
    quizResults.style.display = 'block';
    
    // Show score
    const percentage = Math.round((data.score / data.total) * 100);
    document.getElementById('score-percentage').textContent = percentage;
    document.getElementById('score-count').textContent = data.score;
    
    // Show detailed results
    const detailedResults = document.getElementById('detailed-results');
    detailedResults.innerHTML = '';
    
    data.results.forEach((result, index) => {
        const resultDiv = document.createElement('div');
        resultDiv.style.cssText = `
            padding: 1rem;
            background: ${result.is_correct ? '#d1fae5' : '#fee2e2'};
            border-left: 4px solid ${result.is_correct ? '#10b981' : '#ef4444'};
            border-radius: 8px;
            margin-bottom: 0.5rem;
        `;
        
        resultDiv.innerHTML = `
            <div style="display: flex; align-items: start; gap: 1rem;">
                <span style="font-size: 1.5rem;">${result.is_correct ? '‚úì' : '‚úó'}</span>
                <div style="flex: 1;">
                    <p style="color: #1f2937; font-weight: 600; margin: 0;">Question ${index + 1}</p>
                    <p style="color: #374151; margin: 0.5rem 0 0 0;">${result.explanation}</p>
                </div>
            </div>
        `;
        detailedResults.appendChild(resultDiv);
    });
}

function resetQuiz() {
    document.getElementById('quiz-form').style.display = 'flex';
    document.getElementById('quiz-results').style.display = 'none';
    document.getElementById('quiz-form').reset();
}

function completeModule() {
    alert('Module marked as complete! Excellent work!');
}
</script>

{% endblock %}
